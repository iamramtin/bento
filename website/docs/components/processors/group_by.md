---
title: group_by
type: processor
categories: ["Composition"]
---

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the contents of:
     lib/processor/group_by.go
-->

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


Splits a batch of messages into N batches, where each resulting batch contains a
group of messages determined by conditions that are applied per message of the
original batch.

```yaml
# Config fields, showing default values
group_by: []
```

Once the groups are established a list of processors are applied to their
respective grouped batch, which can be used to label the batch as per their
grouping.

Each group is configured in a list with a condition and a list of processors:

``` yaml
group_by:
- condition:
    static: true
  processors:
  - type: noop
```

Messages are added to the first group that passes and can only belong to a
single group. Messages that do not pass the conditions of any group are placed
in a final batch with no processors applied.

The functionality of this processor depends on being applied across messages
that are batched. You can find out more about batching [in this doc](/docs/configuration/batching).

## Examples

<Tabs defaultValue="Grouped Processing" values={[
{ label: 'Grouped Processing', value: 'Grouped Processing', },
]}>

<TabItem value="Grouped Processing">

Imagine we have a batch of messages that we wish to split into a group of foos and everything else, which should be sent to different output destinations based on those groupings. We also need to send the foos as a tar gzip archive. For this purpose we can use the `group_by` processor with a [`switch`](/docs/components/outputs/switch) output:

```yaml
pipeline:
  processors:
    - group_by:
      - condition:
          bloblang: 'content().contains("this is a foo")'
        processors:
          - archive:
              format: tar
          - compress:
              algorithm: gzip
          - bloblang: 'meta grouping = "foo"'

output:
  switch:
    cases:
      - check: 'meta("grouping") == "foo"'
        output:
          gcp_pubsub:
            project: foo_prod
            topic: only_the_foos
      - output:
          gcp_pubsub:
            project: somewhere_else
            topic: no_foos_here
```

</TabItem>
</Tabs>


