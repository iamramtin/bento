---
title: crdb_changefeed
type: input
status: experimental
categories: ["Integration"]
---

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the contents of:
     lib/input/crdb_changefeed.go
-->

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

:::caution EXPERIMENTAL
This component is experimental and therefore subject to change or removal outside of major version releases.
:::
Listens to a CockroachDB Core Changefeed and creates a message for each row received. Each message is a json object looking like: 
```json
{
	"primary_key": "[\"1a7ff641-3e3b-47ee-94fe-a0cadb56cd8f\", 2]", // stringifed JSON array
	"row": "{\"after\": {\"k\": \"1a7ff641-3e3b-47ee-94fe-a0cadb56cd8f\", \"v\": 2}, \"updated\": \"1637953249519902405.0000000000\"}", // stringified JSON object
	"table": "strm_2"
}
```

```yaml
# Config fields, showing default values
input:
  label: ""
  crdb_changefeed:
    dsn: ""
    root_ca: ""
    tables: []
    options: []
```

Will continue to listen to the Changefeed until shutdown. If provided, will maintain the previous `timestamp` so that in the event of a restart the chanfeed will resume from where it last processed. This is at-least-once processing, as there is a chance that a timestamp is not successfully stored after being emitted and therefore a row may be sent again on restart.

Note: You must have `SET CLUSTER SETTING kv.rangefeed.enabled = true;` on your CRDB cluster

## Fields

### `dsn`

A Data Source Name to identify the target database.


Type: `string`  

```yaml
# Examples

dsn: postgres://foouser:foopass@localhost:5432/foodb?sslmode=disable
```

### `root_ca`

A Root CA Certificate


Type: `string`  

```yaml
# Examples

root_ca: |-
  -----BEGIN CERTIFICATE-----
  FEIWJFOIEW...
  -----END CERTIFICATE-----
```

### `tables`

CSV of tables to be included in the changefeed


Type: `array`  

```yaml
# Examples

tables:
  - table1
  - table2
```

### `options`

CSV of options to be included in the changefeed (WITH X, Y...).
**NOTE: The CURSOR option here will only be applied if a cached cursor value is not found. If the cursor is cached, it will overwrite this option.**


Type: `array`  

```yaml
# Examples

options:
  - UPDATE
  - CURSOR=1536242855577149065.0000000000
```


